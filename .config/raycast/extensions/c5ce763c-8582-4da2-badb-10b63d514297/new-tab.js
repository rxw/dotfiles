"use strict";var jt=Object.create;var le=Object.defineProperty;var Bt=Object.getOwnPropertyDescriptor;var Ht=Object.getOwnPropertyNames;var Gt=Object.getPrototypeOf,Kt=Object.prototype.hasOwnProperty;var Jt=(e,t)=>{for(var r in t)le(e,r,{get:t[r],enumerable:!0})},Be=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let a of Ht(t))!Kt.call(e,a)&&a!==r&&le(e,a,{get:()=>t[a],enumerable:!(n=Bt(t,a))||n.enumerable});return e};var E=(e,t,r)=>(r=e!=null?jt(Gt(e)):{},Be(t||!e||!e.__esModule?le(r,"default",{value:e,enumerable:!0}):r,e)),Zt=e=>Be(le({},"__esModule",{value:!0}),e);var Ar={};Jt(Ar,{default:()=>Dt});module.exports=Zt(Ar);var se=require("react"),A=require("@raycast/api");var _t=E(require("fs")),H=E(require("@raycast/api"));var p=E(require("react")),u=require("@raycast/api");var He=Object.prototype.hasOwnProperty;function ue(e,t){var r,n;if(e===t)return!0;if(e&&t&&(r=e.constructor)===t.constructor){if(r===Date)return e.getTime()===t.getTime();if(r===RegExp)return e.toString()===t.toString();if(r===Array){if((n=e.length)===t.length)for(;n--&&ue(e[n],t[n]););return n===-1}if(!r||typeof e=="object"){n=0;for(r in e)if(He.call(e,r)&&++n&&!He.call(t,r)||!(r in t)||!ue(e[r],t[r]))return!1;return Object.keys(t).length===n}}return e!==e&&t!==t}var L=E(require("node:fs")),V=E(require("node:path")),Xe=E(require("node:crypto")),Re=E(require("node:child_process")),et=require("node:buffer"),X=E(require("node:stream")),tt=require("node:util"),_=require("node:fs/promises");var R=require("react/jsx-runtime"),pe=E(require("node:os")),rt=require("node:url"),Te=globalThis;function Yt(e){let t=(0,p.useRef)(e),r=(0,p.useRef)(0);return ue(e,t.current)||(t.current=e,r.current+=1),(0,p.useMemo)(()=>t.current,[r.current])}function P(e){let t=(0,p.useRef)(e);return t.current=e,t}function nt(e,t){let r=e instanceof Error?e.message:String(e);return(0,u.showToast)({style:u.Toast.Style.Failure,title:t?.title??"Something went wrong",message:t?.message??r,primaryAction:t?.primaryAction??Ge(e),secondaryAction:t?.primaryAction?Ge(e):void 0})}var Ge=e=>{let t=!0,r="[Extension Name]...",n="";try{let o=JSON.parse((0,L.readFileSync)((0,V.join)(u.environment.assetsPath,"..","package.json"),"utf8"));r=`[${o.title}]...`,n=`https://raycast.com/${o.owner||o.author}/${o.name}`,(!o.owner||o.access==="public")&&(t=!1)}catch{}let a=u.environment.isDevelopment||t,s=e instanceof Error?e?.stack||e?.message||"":String(e);return{title:a?"Copy Logs":"Report Error",onAction(o){o.hide(),a?u.Clipboard.copy(s):(0,u.open)(`https://github.com/raycast/extensions/issues/new?&labels=extension%2Cbug&template=extension_bug_report.yml&title=${encodeURIComponent(r)}&extension-url=${encodeURI(n)}&description=${encodeURIComponent(`#### Error:
\`\`\`
${s}
\`\`\`
`)}`)}}};function me(e,t,r){let n=(0,p.useRef)(0),[a,s]=(0,p.useState)({isLoading:!0}),o=P(e),i=P(r?.abortable),c=P(t||[]),l=P(r?.onError),d=P(r?.onData),h=P(r?.onWillExecute),g=P(r?.failureToastOptions),x=P(a.data),$=(0,p.useRef)(null),f=(0,p.useRef)({page:0}),k=(0,p.useRef)(!1),D=(0,p.useRef)(!0),ie=(0,p.useRef)(50),S=(0,p.useCallback)(()=>(i.current&&(i.current.current?.abort(),i.current.current=new AbortController),++n.current),[i]),w=(0,p.useCallback)((...F)=>{let T=S();h.current?.(F),s(b=>({...b,isLoading:!0}));let Y=qt(o.current)(...F);function q(b){return b.name=="AbortError"||T===n.current&&(l.current?l.current(b):u.environment.launchType!==u.LaunchType.Background&&nt(b,{title:"Failed to fetch latest data",primaryAction:{title:"Retry",onAction(G){G.hide(),$.current?.(...c.current||[])}},...g.current}),s({error:b,isLoading:!1})),b}return typeof Y=="function"?(k.current=!0,Y(f.current).then(({data:b,hasMore:G,cursor:Vt})=>(T===n.current&&(f.current&&(f.current.cursor=Vt,f.current.lastItem=b?.[b.length-1]),d.current&&d.current(b,f.current),G&&(ie.current=b.length),D.current=G,s(zt=>f.current.page===0?{data:b,isLoading:!1}:{data:(zt.data||[])?.concat(b),isLoading:!1})),b),b=>(D.current=!1,q(b)))):(k.current=!1,Y.then(b=>(T===n.current&&(d.current&&d.current(b),s({data:b,isLoading:!1})),b),q))},[d,l,c,o,s,$,h,f,g,S]);$.current=w;let M=(0,p.useCallback)(()=>{f.current={page:0};let F=c.current||[];return w(...F)},[w,c]),Z=(0,p.useCallback)(async(F,T)=>{let Y;try{if(T?.optimisticUpdate){S(),typeof T?.rollbackOnError!="function"&&T?.rollbackOnError!==!1&&(Y=structuredClone(x.current?.value));let q=T.optimisticUpdate;s(b=>({...b,data:q(b.data)}))}return await F}catch(q){if(typeof T?.rollbackOnError=="function"){let b=T.rollbackOnError;s(G=>({...G,data:b(G.data)}))}else T?.optimisticUpdate&&T?.rollbackOnError!==!1&&s(b=>({...b,data:Y}));throw q}finally{T?.shouldRevalidateAfter!==!1&&(u.environment.launchType===u.LaunchType.Background||u.environment.commandMode==="menu-bar"?await M():M())}},[M,x,s,S]),ce=(0,p.useCallback)(()=>{f.current.page+=1;let F=c.current||[];w(...F)},[f,c,w]);(0,p.useEffect)(()=>{f.current={page:0},r?.execute!==!1?w(...t||[]):S()},[Yt([t,r?.execute,w]),i,f]),(0,p.useEffect)(()=>()=>{S()},[S]);let Mt=r?.execute!==!1?a.isLoading:!1,Ft={...a,isLoading:Mt},Wt=k.current?{pageSize:ie.current,hasMore:D.current,onLoadMore:ce}:void 0;return{...Ft,revalidate:M,mutate:Z,pagination:Wt}}function qt(e){return e===Promise.all||e===Promise.race||e===Promise.resolve||e===Promise.reject?e.bind(Promise):e}function Ke(e){return typeof e!="function"?!1:/^function\s+\w*\s*\(\s*\)\s*{\s+\[native code\]\s+}$/i.exec(Function.prototype.toString.call(e))!==null}function Qt(e){return e instanceof URLSearchParams?e.toString():e}function at(e,t=[]){function r(n){return"update"in e?e.update(n,"utf8"):e.write(n)}return{dispatch:function(n){n=Qt(n),n===null?this._null():this["_"+typeof n](n)},_object:function(n){let a=/\[object (.*)\]/i,s=Object.prototype.toString.call(n),o=a.exec(s)?.[1]??"unknown:["+s+"]";o=o.toLowerCase();let i=null;if((i=t.indexOf(n))>=0){this.dispatch("[CIRCULAR:"+i+"]");return}else t.push(n);if(Buffer.isBuffer(n))return r("buffer:"),r(n.toString("utf8"));if(o!=="object"&&o!=="function"&&o!=="asyncfunction")if(this["_"+o])this["_"+o](n);else throw new Error('Unknown object type "'+o+'"');else{let c=Object.keys(n);c=c.sort(),Ke(n)||c.splice(0,0,"prototype","__proto__","constructor"),r("object:"+c.length+":");let l=this;return c.forEach(function(d){l.dispatch(d),r(":"),l.dispatch(n[d]),r(",")})}},_array:function(n,a){a=typeof a<"u"?a:!1;let s=this;if(r("array:"+n.length+":"),!a||n.length<=1){n.forEach(function(c){s.dispatch(c)});return}let o=[],i=n.map(function(c){let l=Xt(),d=t.slice();return at(l,d).dispatch(c),o=o.concat(d.slice(t.length)),l.read().toString()});t=t.concat(o),i.sort(),this._array(i,!1)},_date:function(n){r("date:"+n.toJSON())},_symbol:function(n){r("symbol:"+n.toString())},_error:function(n){r("error:"+n.toString())},_boolean:function(n){r("bool:"+n.toString())},_string:function(n){r("string:"+n.length+":"),r(n.toString())},_function:function(n){r("fn:"),Ke(n)?this.dispatch("[native]"):this.dispatch(n.toString()),this.dispatch("function-name:"+String(n.name)),this._object(n)},_number:function(n){r("number:"+n.toString())},_xml:function(n){r("xml:"+n.toString())},_null:function(){r("Null")},_undefined:function(){r("Undefined")},_regexp:function(n){r("regex:"+n.toString())},_uint8array:function(n){r("uint8array:"),this.dispatch(Array.prototype.slice.call(n))},_uint8clampedarray:function(n){r("uint8clampedarray:"),this.dispatch(Array.prototype.slice.call(n))},_int8array:function(n){r("int8array:"),this.dispatch(Array.prototype.slice.call(n))},_uint16array:function(n){r("uint16array:"),this.dispatch(Array.prototype.slice.call(n))},_int16array:function(n){r("int16array:"),this.dispatch(Array.prototype.slice.call(n))},_uint32array:function(n){r("uint32array:"),this.dispatch(Array.prototype.slice.call(n))},_int32array:function(n){r("int32array:"),this.dispatch(Array.prototype.slice.call(n))},_float32array:function(n){r("float32array:"),this.dispatch(Array.prototype.slice.call(n))},_float64array:function(n){r("float64array:"),this.dispatch(Array.prototype.slice.call(n))},_arraybuffer:function(n){r("arraybuffer:"),this.dispatch(new Uint8Array(n))},_url:function(n){r("url:"+n.toString())},_map:function(n){r("map:");let a=Array.from(n);this._array(a,!0)},_set:function(n){r("set:");let a=Array.from(n);this._array(a,!0)},_file:function(n){r("file:"),this.dispatch([n.name,n.size,n.type,n.lastModified])},_blob:function(){throw Error(`Hashing Blob objects is currently not supported
(see https://github.com/puleos/object-hash/issues/26)
Use "options.replacer" or "options.ignoreUnknown"
`)},_domwindow:function(){r("domwindow")},_bigint:function(n){r("bigint:"+n.toString())},_process:function(){r("process")},_timer:function(){r("timer")},_pipe:function(){r("pipe")},_tcp:function(){r("tcp")},_udp:function(){r("udp")},_tty:function(){r("tty")},_statwatcher:function(){r("statwatcher")},_securecontext:function(){r("securecontext")},_connection:function(){r("connection")},_zlib:function(){r("zlib")},_context:function(){r("context")},_nodescript:function(){r("nodescript")},_httpparser:function(){r("httpparser")},_dataview:function(){r("dataview")},_signal:function(){r("signal")},_fsevent:function(){r("fsevent")},_tlswrap:function(){r("tlswrap")}}}function Xt(){return{buf:"",write:function(e){this.buf+=e},end:function(e){this.buf+=e},read:function(){return this.buf}}}function er(e,t){let r=this[e];return r instanceof Date?`__raycast_cached_date__${r.toISOString()}`:Buffer.isBuffer(r)?`__raycast_cached_buffer__${r.toString("base64")}`:t}function tr(e,t){return typeof t=="string"&&t.startsWith("__raycast_cached_date__")?new Date(t.replace("__raycast_cached_date__","")):typeof t=="string"&&t.startsWith("__raycast_cached_buffer__")?Buffer.from(t.replace("__raycast_cached_buffer__",""),"base64"):t}function de(e){let t=Xe.default.createHash("sha1");return at(t).dispatch(e),t.digest("hex")}var rr=Symbol("cache without namespace"),Je=new Map;function O(e,t,r){let n=r?.cacheNamespace||rr,a=Je.get(n)||Je.set(n,new u.Cache({namespace:r?.cacheNamespace})).get(n);if(!a)throw new Error("Missing cache");let s=P(e),o=P(t),i=(0,p.useSyncExternalStore)(a.subscribe,()=>{try{return a.get(s.current)}catch(h){console.error("Could not get Cache data:",h);return}}),c=(0,p.useMemo)(()=>{if(typeof i<"u"){if(i==="undefined")return;try{return JSON.parse(i,tr)}catch(h){return console.warn("The cached data is corrupted",h),o.current}}else return o.current},[i,o]),l=P(c),d=(0,p.useCallback)(h=>{let g=typeof h=="function"?h(l.current):h;if(typeof g>"u")a.set(s.current,"undefined");else{let x=JSON.stringify(g,er);a.set(s.current,x)}return g},[a,s,l]);return[c,d]}var Q=Symbol();function ot(e,t,r){let{initialData:n,keepPreviousData:a,internal_cacheKeySuffix:s,...o}=r||{},i=(0,p.useRef)(null),[c,l]=O(de(t||[])+s,Q,{cacheNamespace:de(e)}),d=(0,p.useRef)(c!==Q?c:n),h=(0,p.useRef)(void 0),{mutate:g,revalidate:x,...$}=me(e,t||[],{...o,onData(S,w){h.current=w,o.onData&&o.onData(S,w),!(w&&w.page>0)&&(i.current="promise",d.current=S,l(S))}}),f,k=$.pagination;h.current&&h.current.page>0&&$.data?f=$.data:i.current==="promise"?f=d.current:a&&c!==Q?(f=c,k&&(k.hasMore=!0,k.pageSize=c.length)):a&&c===Q?f=d.current:c!==Q?(f=c,k&&(k.hasMore=!0,k.pageSize=c.length)):f=n;let D=P(f),ie=(0,p.useCallback)(async(S,w)=>{let M;try{if(w?.optimisticUpdate){typeof w?.rollbackOnError!="function"&&w?.rollbackOnError!==!1&&(M=structuredClone(D.current));let Z=w.optimisticUpdate(D.current);i.current="cache",d.current=Z,l(Z)}return await g(S,{shouldRevalidateAfter:w?.shouldRevalidateAfter})}catch(Z){if(typeof w?.rollbackOnError=="function"){let ce=w.rollbackOnError(D.current);i.current="cache",d.current=ce,l(ce)}else w?.optimisticUpdate&&w?.rollbackOnError!==!1&&(i.current="cache",d.current=M,l(M));throw Z}},[l,g,D,d,i]);return(0,p.useEffect)(()=>{c!==Q&&(i.current="cache",d.current=c)},[c]),{data:f,isLoading:$.isLoading,error:$.error,mutate:h.current&&h.current.page>0?g:ie,pagination:k,revalidate:x}}var fe=e=>!!e&&typeof e=="object"&&typeof e.removeListener=="function"&&typeof e.emit=="function"&&typeof e.reallyExit=="function"&&typeof e.listeners=="function"&&typeof e.kill=="function"&&typeof e.pid=="number"&&typeof e.on=="function",Pe=Symbol.for("signal-exit emitter"),_e=class{constructor(){if(this.emitted={afterExit:!1,exit:!1},this.listeners={afterExit:[],exit:[]},this.count=0,this.id=Math.random(),Te[Pe])return Te[Pe];Object.defineProperty(Te,Pe,{value:this,writable:!1,enumerable:!1,configurable:!1})}on(t,r){this.listeners[t].push(r)}removeListener(t,r){let n=this.listeners[t],a=n.indexOf(r);a!==-1&&(a===0&&n.length===1?n.length=0:n.splice(a,1))}emit(t,r,n){if(this.emitted[t])return!1;this.emitted[t]=!0;let a=!1;for(let s of this.listeners[t])a=s(r,n)===!0||a;return t==="exit"&&(a=this.emit("afterExit",r,n)||a),a}},Ae=class{onExit(){return()=>{}}load(){}unload(){}},Ie=class{#i;#t;#e;#o;#s;#a;#n;#r;constructor(t){this.#i=process.platform==="win32"?"SIGINT":"SIGHUP",this.#t=new _e,this.#a={},this.#n=!1,this.#r=[],this.#r.push("SIGHUP","SIGINT","SIGTERM"),globalThis.process.platform!=="win32"&&this.#r.push("SIGALRM","SIGABRT","SIGVTALRM","SIGXCPU","SIGXFSZ","SIGUSR2","SIGTRAP","SIGSYS","SIGQUIT","SIGIOT"),globalThis.process.platform==="linux"&&this.#r.push("SIGIO","SIGPOLL","SIGPWR","SIGSTKFLT"),this.#e=t,this.#a={};for(let r of this.#r)this.#a[r]=()=>{let n=this.#e.listeners(r),{count:a}=this.#t,s=t;if(typeof s.__signal_exit_emitter__=="object"&&typeof s.__signal_exit_emitter__.count=="number"&&(a+=s.__signal_exit_emitter__.count),n.length===a){this.unload();let o=this.#t.emit("exit",null,r),i=r==="SIGHUP"?this.#i:r;o||t.kill(t.pid,i)}};this.#s=t.reallyExit,this.#o=t.emit}onExit(t,r){if(!fe(this.#e))return()=>{};this.#n===!1&&this.load();let n=r?.alwaysLast?"afterExit":"exit";return this.#t.on(n,t),()=>{this.#t.removeListener(n,t),this.#t.listeners.exit.length===0&&this.#t.listeners.afterExit.length===0&&this.unload()}}load(){if(!this.#n){this.#n=!0,this.#t.count+=1;for(let t of this.#r)try{let r=this.#a[t];r&&this.#e.on(t,r)}catch{}this.#e.emit=(t,...r)=>this.#l(t,...r),this.#e.reallyExit=t=>this.#c(t)}}unload(){this.#n&&(this.#n=!1,this.#r.forEach(t=>{let r=this.#a[t];if(!r)throw new Error("Listener not defined for signal: "+t);try{this.#e.removeListener(t,r)}catch{}}),this.#e.emit=this.#o,this.#e.reallyExit=this.#s,this.#t.count-=1)}#c(t){return fe(this.#e)?(this.#e.exitCode=t||0,this.#t.emit("exit",this.#e.exitCode,null),this.#s.call(this.#e,this.#e.exitCode)):0}#l(t,...r){let n=this.#o;if(t==="exit"&&fe(this.#e)){typeof r[0]=="number"&&(this.#e.exitCode=r[0]);let a=n.call(this.#e,t,...r);return this.#t.emit("exit",this.#e.exitCode,null),a}else return n.call(this.#e,t,...r)}},Ce=null,nr=(e,t)=>(Ce||(Ce=fe(process)?new Ie(process):new Ae),Ce.onExit(e,t));function Ze(e,{timeout:t}={}){let r=new Promise((i,c)=>{e.on("exit",(l,d)=>{i({exitCode:l,signal:d,timedOut:!1})}),e.on("error",l=>{c(l)}),e.stdin&&e.stdin.on("error",l=>{c(l)})}),n=nr(()=>{e.kill()});if(t===0||t===void 0)return r.finally(()=>n());let a,s=new Promise((i,c)=>{a=setTimeout(()=>{e.kill("SIGTERM"),c(Object.assign(new Error("Timed out"),{timedOut:!0,signal:"SIGTERM"}))},t)}),o=r.finally(()=>{clearTimeout(a)});return Promise.race([s,o]).finally(()=>n())}var Oe=class extends Error{constructor(){super("The output is too big"),this.name="MaxBufferError"}};function ar(e){let{encoding:t}=e,r=t==="buffer",n=new X.default.PassThrough({objectMode:!1});t&&t!=="buffer"&&n.setEncoding(t);let a=0,s=[];return n.on("data",o=>{s.push(o),a+=o.length}),n.getBufferedValue=()=>r?Buffer.concat(s,a):s.join(""),n.getBufferedLength=()=>a,n}async function Ye(e,t){let r=ar(t);return await new Promise((n,a)=>{let s=o=>{o&&r.getBufferedLength()<=et.constants.MAX_LENGTH&&(o.bufferedData=r.getBufferedValue()),a(o)};(async()=>{try{await(0,tt.promisify)(X.default.pipeline)(e,r),n()}catch(o){s(o)}})(),r.on("data",()=>{r.getBufferedLength()>8e7&&s(new Oe)})}),r.getBufferedValue()}async function qe(e,t){e.destroy();try{return await t}catch(r){return r.bufferedData}}async function Qe({stdout:e,stderr:t},{encoding:r},n){let a=Ye(e,{encoding:r}),s=Ye(t,{encoding:r});try{return await Promise.all([n,a,s])}catch(o){return Promise.all([{error:o,exitCode:null,signal:o.signal,timedOut:o.timedOut||!1},qe(e,a),qe(t,s)])}}var he=class extends Error{constructor(t){super(t),this.name="PermissionError"}};function or(e){return e instanceof Error&&e.name==="PermissionError"}async function sr(e,t,r){if(!(0,L.existsSync)(e))throw new Error("The database does not exist");let n;try{n=await(l=>import(l))("node:sqlite")}catch{return ir(e,t,r)}let a=new n.DatabaseSync(e,{open:!1,readOnly:!0}),s=r?.signal;try{a.open()}catch(c){if(console.log(c),c.message.match("(5)")||c.message.match("(14)")){let l;if(!l){let d=V.default.join(pe.default.tmpdir(),"useSQL",de(e));await(0,_.mkdir)(d,{recursive:!0}),W(s),l=V.default.join(d,"db.db"),await(0,_.copyFile)(e,l),await(0,_.writeFile)(l+"-shm",""),await(0,_.writeFile)(l+"-wal",""),W(s)}a=new n.DatabaseSync(l,{open:!1,readOnly:!0}),a.open(),W(s)}}let o=a.prepare(t);W(s);let i=o.all();return a.close(),i}async function ir(e,t,r){let n=r?.signal,a=Re.default.spawn("sqlite3",["--json","--readonly",e,t],{signal:n}),s=Ze(a),[{error:o,exitCode:i,signal:c},l,d]=await Qe(a,{encoding:"utf-8"},s);if(W(n),d.match("(5)")||d.match("(14)")){let h;if(!h){let g=V.default.join(pe.default.tmpdir(),"useSQL",de(e));await(0,_.mkdir)(g,{recursive:!0}),W(n),h=V.default.join(g,"db.db"),await(0,_.copyFile)(e,h),await(0,_.writeFile)(h+"-shm",""),await(0,_.writeFile)(h+"-wal",""),W(n)}a=Re.default.spawn("sqlite3",["--json","--readonly","--vfs","unix-none",h,t],{signal:n}),s=Ze(a),[{error:o,exitCode:i,signal:c},l,d]=await Qe(a,{encoding:"utf-8"},s),W(n)}if(o||i!==0||c!==null)throw d.includes("authorization denied")?new he("You do not have permission to access the database."):new Error(d||"Unknown error");return JSON.parse(l.trim()||"[]")}function W(e){if(e?.aborted){let t=new Error("aborted");throw t.name="AbortError",t}}function st(e,t,r){let{permissionPriming:n,...a}=r||{},[s,o]=(0,p.useState)(null),i=P(r||{}),c=(0,p.useRef)(null),l=(0,p.useCallback)(h=>{console.error(h);let g=h instanceof Error&&h.message.includes("authorization denied")?new he("You do not have permission to access the database."):h;or(g)?o((0,R.jsx)(cr,{priming:i.current.permissionPriming})):i.current.onError?i.current.onError(g):u.environment.launchType!==u.LaunchType.Background&&nt(g,{title:"Cannot query the data"})},[i]),d=(0,p.useMemo)(()=>{if(!(0,L.existsSync)(e))throw new Error("The database does not exist");return async(h,g)=>{let x=c.current?.signal;return sr(h,g,{signal:x})}},[e]);return{...me(d,[e,t],{...a,onError:l}),permissionView:s}}function cr(e){let t=parseInt(pe.default.release().split(".")[0])>=22,r=t?"Settings":"Preferences",n=t?{title:"Open System Settings -> Privacy",target:"x-apple.systempreferences:com.apple.preference.security?Privacy_AllFiles"}:{title:"Open System Preferences -> Security",target:"x-apple.systempreferences:com.apple.preference.security?Privacy_AllFiles"};return u.environment.commandMode==="menu-bar"?(0,R.jsxs)(u.MenuBarExtra,{icon:u.Icon.Warning,title:u.environment.commandName,children:[(0,R.jsx)(u.MenuBarExtra.Item,{title:"Raycast needs full disk access",tooltip:`You can revert this access in ${r} whenever you want`}),e.priming?(0,R.jsx)(u.MenuBarExtra.Item,{title:e.priming,tooltip:`You can revert this access in ${r} whenever you want`}):null,(0,R.jsx)(u.MenuBarExtra.Separator,{}),(0,R.jsx)(u.MenuBarExtra.Item,{title:n.title,onAction:()=>(0,u.open)(n.target)})]}):(0,R.jsx)(u.List,{children:(0,R.jsx)(u.List.EmptyView,{icon:{source:{light:"https://raycast.com/uploads/extensions-utils-security-permissions-light.png",dark:"https://raycast.com/uploads/extensions-utils-security-permissions-dark.png"}},title:"Raycast needs full disk access.",description:`${e.priming?e.priming+`
`:""}You can revert this access in ${r} whenever you want.`,actions:(0,R.jsx)(u.ActionPanel,{children:(0,R.jsx)(u.Action.Open,{...n})})})})}function ge(e,t){try{let r=o=>o.startsWith("http")?o:`https://${o}`,a=(typeof e=="string"?new rt.URL(r(e)):e).hostname;switch(process.env.FAVICON_PROVIDER??"raycast"){case"none":return{source:t?.fallback??u.Icon.Link,mask:t?.mask};case"apple":return{source:t?.fallback??u.Icon.Link,mask:t?.mask};case"duckduckgo":case"duckDuckGo":return{source:`https://icons.duckduckgo.com/ip3/${a}.ico`,fallback:t?.fallback??u.Icon.Link,mask:t?.mask};case"google":return{source:`https://www.google.com/s2/favicons?sz=${t?.size??64}&domain=${a}`,fallback:t?.fallback??u.Icon.Link,mask:t?.mask};case"legacy":case"raycast":default:return{source:`https://api.ray.so/favicon?url=${a}&size=${t?.size??64}`,fallback:t?.fallback??u.Icon.Link,mask:t?.mask}}}catch(r){return console.error(r),u.Icon.Link}}var it=E(require("node:fs")),ct=E(require("node:path")),K=require("@raycast/api"),lt=e=>{let t=!0,r="[Extension Name]...",n="";try{let o=JSON.parse(it.readFileSync(ct.join(K.environment.assetsPath,"..","package.json"),"utf8"));r=`[${o.title}]...`,n=`https://raycast.com/${o.owner||o.author}/${o.name}`,(!o.owner||o.access==="public")&&(t=!1)}catch{}let a=K.environment.isDevelopment||t,s=e instanceof Error?e?.stack||e?.message||"":String(e);return{title:a?"Copy Logs":"Report Error",onAction(o){o.hide(),a?K.Clipboard.copy(s):(0,K.open)(`https://github.com/raycast/extensions/issues/new?&labels=extension%2Cbug&template=extension_bug_report.yml&title=${encodeURIComponent(r)}&extension-url=${encodeURI(n)}&description=${encodeURIComponent(`#### Error:
\`\`\`
${s}
\`\`\`
`)}`)}}};var te=require("react");var re=E(require("path"));var ut=E(require("fs"));var lr=()=>{try{let e=$e(),t=ut.default.readFileSync(e,"utf-8"),r=JSON.parse(t).profile.info_cache;return r?Object.keys(r)[0]:"Default"}catch{return"Default"}},ft=["Application Support","Google","Chrome"],dt=["Application Support","Google","Chrome","Local State"],I=lr(),J="CHROME_PROFILE_KEY",be="CHROME_PROFILES_KEY",ht=`
  # \u{1F6A8}Error: Google Chrome browser is not installed
  ## This extension depends on Google Chrome browser. You must install it to continue.

  If you have [Homebrew](https://brew.sh/) installed then press \u23CE (Enter Key) to install Google Chrome browser.

  [Click here](https://www.google.com/chrome/) if you want to download manually.

  [![Google Chrome](https://www.google.com/chrome/static/images/chrome-logo-m100.svg)]()
`;var pt=`
# \u{1F6A8}Error: Something happened while trying to run your command

[![Google Chrome](https://www.google.com/chrome/static/images/chrome-logo-m100.svg)]()
`,ye="An Error Occurred",we="Google Chrome not installed";var mt=require("@raycast/api"),gt=()=>{if(!process.env.HOME)throw new Error("$HOME environment variable is not set.");return re.default.join(process.env.HOME,"Library")},ur=(e,t)=>{let{profilePath:r}=(0,mt.getPreferenceValues)(),n;return r?n=re.default.join(r,e):n=re.default.join(gt(),...ft,t??I,e),n},bt=e=>ur("History",e),$e=()=>re.default.join(gt(),...dt);var fr=require("@raycast/api");var dr=require("react/jsx-runtime");var wt=require("react"),C=require("@raycast/api"),Le=require("child_process");var $t=require("os"),kt=require("path"),ke=require("react/jsx-runtime"),hr=(()=>{try{return(0,Le.execSync)("brew --prefix",{encoding:"utf8"}).trim()}catch{return(0,$t.cpus)()[0].model.includes("Apple")?"/opt/homebrew":"/usr/local"}})();function yt(){return(0,kt.join)(hr,"bin/brew")}function pr(e){try{return(0,Le.execSync)(`${yt()} install --cask ${e}`,{maxBuffer:10*1024*1024})}catch(t){let r=t;throw r&&r.code===127?(r.stderr=`Brew executable not found at ${yt()}`,r):t}}function xe(){let[e,t]=(0,wt.useState)(!0);return(0,ke.jsx)(C.Detail,{actions:(0,ke.jsx)(C.ActionPanel,{children:e&&(0,ke.jsx)(C.Action,{title:"Install with Homebrew",onAction:async()=>{if(!e)return;let r=new C.Toast({style:C.Toast.Style.Animated,title:"Installing..."});await r.show();try{pr("google-chrome"),await r.hide()}catch{await r.hide(),await(0,C.showToast)(C.Toast.Style.Failure,ye,"An unknown error occurred while trying to install")}r.title="Installed! Please go back and try again.",r.style=C.Toast.Style.Success,await r.show(),t(!1)}})}),markdown:ht})}var ee=require("@raycast/api");var vt=require("react/jsx-runtime");function xt(){return(0,ee.showToast)(ee.Toast.Style.Failure,ye,"Something happened while trying to run your command"),(0,vt.jsx)(ee.Detail,{markdown:pt})}var m=require("@raycast/api");var Et=E(require("node:process"),1),St=require("node:util"),Ue=require("node:child_process"),mr=(0,St.promisify)(Ue.execFile);async function z(e,{humanReadableOutput:t=!0,signal:r}={}){if(Et.default.platform!=="darwin")throw new Error("macOS only");let n=t?[]:["-ss"],a={};r&&(a.signal=r);let{stdout:s}=await mr("osascript",["-e",e,n],a);return s.trim()}var B=require("@raycast/api");var j=class e{constructor(t,r,n,a,s,o){this.title=t;this.url=r;this.favicon=n;this.windowsId=a;this.tabIndex=s;this.sourceLine=o}static TAB_CONTENTS_SEPARATOR="~~~";static parse(t){let r=t.split(this.TAB_CONTENTS_SEPARATOR);return new e(r[0],r[1],r[2],+r[3],+r[4],t)}key(){return`${this.windowsId}${e.TAB_CONTENTS_SEPARATOR}${this.tabIndex}`}urlWithoutScheme(){try{return this.url.replace(/(^\w+:|^)\/\//,"").replace("www.","")}catch{return this.url}}realFavicon(){try{return new URL(this.favicon||"/favicon.ico",this.url).href}catch{return this.favicon||""}}googleFavicon(){try{return ge(this.url)}catch{return{source:""}}}};async function Tt(e){let t=e?`execute t javascript \xAC
        "document.head.querySelector('link[rel~=icon]') ? document.head.querySelector('link[rel~=icon]').href : '';"`:'""';await ve();try{return(await z(`
      set _output to ""
      tell application "Google Chrome"
        repeat with w in windows
          set _w_id to get id of w as inches as string
          set _tab_index to 1
          repeat with t in tabs of w
            set _title to get title of t
            set _url to get URL of t
            set _favicon to ${t}
            set _output to (_output & _title & "${j.TAB_CONTENTS_SEPARATOR}" & _url & "${j.TAB_CONTENTS_SEPARATOR}" & _favicon & "${j.TAB_CONTENTS_SEPARATOR}" & _w_id & "${j.TAB_CONTENTS_SEPARATOR}" & _tab_index & "\\n")
            set _tab_index to _tab_index + 1
          end repeat
        end repeat
      end tell
      return _output
  `)).split(`
`).filter(n=>n.length!==0).map(n=>j.parse(n))}catch(r){return r.message.includes(`Can't get application "Google Chrome"`)&&B.LocalStorage.removeItem("is-installed"),await ve(),[]}}async function ne({url:e,query:t,profileCurrent:r,profileOriginal:n,openTabInProfile:a}){setTimeout(()=>{(0,B.popToRoot)({clearSearchBar:!0})},3e3),await Promise.all([(0,B.closeMainWindow)({clearRootSearch:!0}),ve()]);let s="",o=i=>`
    set profile to quoted form of "${i}"
    set link to quoted form of "${e||"about:blank"}"
    do shell script "open -na 'Google Chrome' --args --profile-directory=" & profile & " " & link
  `;switch(a){case"default":s=`
        set winExists to false
        tell application "Google Chrome"
            repeat with win in every window
                if index of win is 1 then
                    set winExists to true
                    exit repeat
                end if
            end repeat

            if not winExists then
                make new window
            else
                activate
            end if

            tell window 1
                set newTab to make new tab `+(e?`with properties {URL:"${e}"}`:t?'with properties {URL:"https://www.google.com/search?q='+t+'"}':"")+`
            end tell
        end tell
        return true

  `;break;case"profile_current":s=o(r);break;case"profile_original":s=o(n);break}return await z(s)}async function Pt(e){await z(`
    tell application "Google Chrome"
      activate
      set _wnd to first window where id is ${e.windowsId}
      set index of _wnd to 1
      set active tab index of _wnd to ${e.tabIndex}
    end tell
    return true
  `)}async function Ct(e){await z(`
    tell application "Google Chrome"
      activate
      set _wnd to first window where id is ${e.windowsId}
      set index of _wnd to 1
      set active tab index of _wnd to ${e.tabIndex}
      close active tab of _wnd
    end tell
    return true
  `)}async function Rt(e){await z(`
    tell application "Google Chrome"
      activate
      set _wnd to first window where id is ${e.windowsId}
      set index of _wnd to 1
      set active tab index of _wnd to ${e.tabIndex}
      tell active tab of _wnd to reload
    end tell
    return true
  `)}var ve=async()=>{if(await B.LocalStorage.getItem("is-installed"))return;if(await z(`
set isInstalled to false
try
    do shell script "osascript -e 'exists application \\"Google Chrome\\"'"
    set isInstalled to true
end try

return isInstalled`)==="false")throw new Error(we);B.LocalStorage.setItem("is-installed",!0)};async function Ne(e){await ve(),await z(`
    set link to quoted form of "${e}"
    do shell script "open -na 'Google Chrome' --args --guest " & link
  `)}var y=require("react/jsx-runtime"),U=class{static NewTab=br;static TabList=yr;static TabHistory=wr};function br({query:e,url:t}){let{openTabInProfile:r}=(0,m.getPreferenceValues)(),[n]=O(J,I),a="Open Empty Tab";return e?a=`Search "${e}"`:t&&(a=`Open URL "${t}"`),(0,y.jsx)(m.ActionPanel,{title:"New Tab",children:(0,y.jsx)(m.Action,{onAction:()=>ne({url:t,query:e,profileCurrent:n,openTabInProfile:r}),title:a})})}function yr({tab:e,onTabClosed:t}){return(0,y.jsxs)(m.ActionPanel,{title:e.title,children:[(0,y.jsx)($r,{tab:e}),(0,y.jsx)(xr,{tab:e}),(0,y.jsx)(m.Action,{title:"Open in Guest Window",icon:{source:m.Icon.Person},onAction:async()=>{try{await Ne(e.url),await(0,m.closeMainWindow)()}catch(r){throw r instanceof Error?new Error(r.message):r}}}),(0,y.jsx)(m.Action.CopyToClipboard,{title:"Copy URL",content:e.url}),(0,y.jsx)(m.Action.CopyToClipboard,{title:"Copy Title",content:e.title,shortcut:{modifiers:["cmd","shift"],key:"enter"}}),(0,y.jsx)(kr,{tab:e,onTabClosed:t}),(0,y.jsx)(m.ActionPanel.Section,{children:(0,y.jsx)(m.Action.CreateQuicklink,{quicklink:{link:e.url,name:e.title,application:"Google Chrome"},shortcut:{modifiers:["cmd"],key:"s"}})})]})}function wr({title:e,url:t,profile:r}){let{openTabInProfile:n}=(0,m.getPreferenceValues)(),[a]=O(J,I);return(0,y.jsxs)(m.ActionPanel,{title:e,children:[(0,y.jsx)(m.Action,{onAction:()=>ne({url:t,profileOriginal:r,profileCurrent:a,openTabInProfile:n}),title:"Open"}),(0,y.jsx)(m.Action,{title:"Open in Guest Window",icon:{source:m.Icon.Person},onAction:async()=>{await Ne(t),await(0,m.closeMainWindow)()}}),(0,y.jsxs)(m.ActionPanel.Section,{title:"Open in profile",children:[(0,y.jsx)(m.Action,{onAction:()=>ne({url:t,profileOriginal:r,profileCurrent:a,openTabInProfile:"profile_current"}),title:"Open in Current Profile"}),(0,y.jsx)(m.Action,{onAction:()=>ne({url:t,profileOriginal:r,profileCurrent:a,openTabInProfile:"profile_original"}),title:"Open in Original Profile"})]}),(0,y.jsx)(m.Action.CopyToClipboard,{title:"Copy URL",content:t,shortcut:{modifiers:["cmd"],key:"c"}})]})}function $r(e){async function t(){try{await Pt(e.tab),await(0,m.closeMainWindow)()}catch(r){throw r instanceof Error?new Error("Issue with tab: '"+e.tab.sourceLine+`'
`+r.message):r}}return(0,y.jsx)(m.ActionPanel.Item,{title:"Open Tab",icon:{source:m.Icon.Eye},onAction:t})}function kr(e){async function t(){await Ct(e.tab),await(0,m.closeMainWindow)(),e.onTabClosed?.()}return(0,y.jsx)(m.Action,{title:"Close Tab",icon:{source:m.Icon.XMarkCircle},onAction:t,shortcut:{modifiers:["cmd","shift"],key:"w"}})}function xr(e){async function t(){try{await Rt(e.tab),await(0,m.closeMainWindow)()}catch(r){throw r instanceof Error?new Error("Issue with tab: '"+e.tab.sourceLine+`'
`+r.message):r}}return(0,y.jsx)(m.Action,{title:"Reload Tab",icon:{source:m.Icon.ArrowClockwise},onAction:t,shortcut:{modifiers:["cmd","shift"],key:"r"}})}var N=require("@raycast/api");var oe=require("react/jsx-runtime"),ae=class{static TabList=Sr;static TabHistory=Er};function vr(e){let t=["javascript:","data:","about:","chrome:","file:"],r=e.toLowerCase().trim();if(t.some(n=>r.startsWith(n)))return{icon:{source:N.Icon.ExclamationMark,tintColor:N.Color.Orange},isInvalid:!0};try{return new URL(e),{icon:ge(e),isInvalid:!1}}catch{return{icon:{source:N.Icon.ExclamationMark,tintColor:N.Color.Orange},isInvalid:!0}}}function Er({profile:e,entry:{url:t,title:r,id:n},type:a}){let{icon:s,isInvalid:o}=vr(t);return(0,oe.jsx)(N.List.Item,{id:`${e}-${a}-${n}`,title:r,subtitle:t,icon:s,accessories:o?[{text:"\u26A0\uFE0F Invalid URL - Cannot open",tooltip:"This URL uses an unsupported protocol"}]:void 0,actions:(0,oe.jsx)(U.TabHistory,{title:r,url:t,profile:e})})}function Sr(e){return(0,oe.jsx)(N.List.Item,{title:e.tab.title,subtitle:e.tab.urlWithoutScheme(),keywords:[e.tab.urlWithoutScheme()],actions:(0,oe.jsx)(U.TabList,{tab:e.tab,onTabClosed:e.onTabClosed}),icon:e.useOriginalFavicon?e.tab.realFavicon():e.tab.googleFavicon()})}function Ee(e){if(!e)return{includeTerms:[],excludeTerms:[]};let t=e.trim().split(/\s+/),r=[],n=[];for(let a of t)a.startsWith("\\-")&&a.length>1?r.push(a.slice(1).toLowerCase()):a.startsWith("-")&&a.length>1?n.push(a.slice(1).toLowerCase()):a.length>0&&a!=="-"&&r.push(a.toLowerCase());return{includeTerms:r,excludeTerms:n}}function De(e,t){let{includeTerms:r,excludeTerms:n}=t,a=r.length===0||r.every(o=>e.includes(o)),s=n.length===0||!n.some(o=>e.includes(o));return a&&s}var It=require("react/jsx-runtime"),Tr=(e,t,r)=>{let n=i=>i.replace(/'/g,"''"),a=t.map(i=>`(${e}.title LIKE '%${n(i)}%' OR ${e}.url LIKE '%${n(i)}%')`),s=r.map(i=>`NOT (${e}.title LIKE '%${n(i)}%' OR ${e}.url LIKE '%${n(i)}%')`),o=[...a,...s];return o.length>0?o.join(" AND "):"1=1"},Pr=(e,t,r,n)=>`SELECT id,
            url,
            title,
            datetime(${t} /
                     1000000 +
                     (strftime('%s', '1601-01-01')),
                     'unixepoch',
                     'localtime') as lastVisited
     FROM ${e}
     WHERE ${Tr(e,r,n)}
     AND last_visit_time > 0
     ORDER BY ${t} DESC LIMIT 30;`,Cr=(e,t)=>{let r=Ee(t||""),n=Pr("urls","last_visit_time",r.includeTerms,r.excludeTerms),a=bt(e);if(!_t.existsSync(a))return{isLoading:!1,data:[],errorView:(0,It.jsx)(xe,{})};let[s,o]=(0,te.useState)(!1),[i,c]=(0,te.useState)(0),[l,d]=(0,te.useState)(null);(0,te.useEffect)(()=>()=>{l&&clearTimeout(l)},[l]);let{data:h,isLoading:g,permissionView:x,revalidate:$}=st(a,n,{onData(){o(!1),c(0),d(null)},onError(f){if(i<1){o(!0),c(i+1);let k=setTimeout(()=>{$(),clearTimeout(k)},1e3);d(k)}else o(!1),c(0),d(null),H.environment.launchType!==H.LaunchType.Background&&H.showToast({style:H.Toast.Style.Failure,title:"Failed to load history",message:f.message,primaryAction:lt(f)})}});return{data:h,isLoading:g||s,errorView:x,revalidate:$}};function At(e,t){return Cr(e,t)}var Me=require("react");var Ot=require("@raycast/api");var Fe=require("react/jsx-runtime");function Lt(e=""){let{useOriginalFavicon:t}=(0,Ot.getPreferenceValues)(),[r,n]=(0,Me.useState)(),[a,s]=(0,Me.useState)(!1),{isLoading:o,data:i}=me(async(l,d)=>{let h=await Tt(l),g=Ee(d);return n(void 0),s(h.length===0),g.includeTerms.length===0&&g.excludeTerms.length===0?h:h.filter(x=>{try{let $=`${x.title.toLowerCase()} ${x.urlWithoutScheme().toLowerCase()}`;return De($,g)}catch{let $=`${x.title.toLowerCase()} ${x.url.toLowerCase()}`;return De($,g)}})},[t,e],{onError(l){l.message===we?n((0,Fe.jsx)(xe,{})):n((0,Fe.jsx)(xt,{}))}});return{data:a?[]:i||[],isLoading:o,errorView:r}}var We=require("@raycast/api"),Ve=require("react");var Se=require("fs");var ze=require("react/jsx-runtime");async function Rr(){let e=$e();if(!(0,Se.existsSync)(e))return[{name:"Default",id:"Default"}];let t=await Se.promises.readFile(e,"utf-8"),r=JSON.parse(t).profile.info_cache;return Object.entries(r).map(([n,a])=>({name:a.name,id:n}))}function je({onProfileSelected:e}){let[t,r]=O(J,I),[n,a]=O(be,[{name:"Person 1",id:I}]),{data:s}=ot(Rr);return(0,Ve.useEffect)(()=>{s&&(a(s),t||(s.length>0?r(s[0].id):r(I)))},[s]),(0,Ve.useEffect)(()=>{t&&e?.(t)},[t]),!n||n.length<2?null:(0,ze.jsx)(We.List.Dropdown,{tooltip:"Select Chrome Profile",value:t,onChange:r,children:n.map(o=>(0,ze.jsx)(We.List.Dropdown.Item,{value:o.id,title:o.name},o.id))})}var Ut=require("url");function Nt(e){let t=e.trim();if(!t)return{type:"search",value:t};if(t.startsWith("http://")||t.startsWith("https://"))try{return new Ut.URL(t),{type:"url",value:t}}catch{return{type:"search",value:t}}if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)(?::\d+)?$/.test(t))return{type:"url",value:`https://${t}`};if(/^localhost(?::\d+)?$/i.test(t))return{type:"url",value:`http://${t}`};if(t.includes(".")&&!/\s/.test(t)&&!t.endsWith(".")){let a=t.split("."),s=a[a.length-1],o=a[0];if(a.length>1&&s.length>=2&&o.length>0)return{type:"url",value:`https://${t}`}}return{type:"search",value:t}}var v=require("react/jsx-runtime");function _r(e,t){if(!t||t.length===0)return[];let r=t.findIndex(n=>n?.profile?.id===e);if(r>0){let[n]=t.splice(r,1);t.unshift(n)}return t}function Dt(){let[e,t]=(0,se.useState)(),[r]=O(be),[n]=O(J,I),[a,s]=(0,se.useState)([]),o=At(n,e),{data:i,isLoading:c,errorView:l}=Lt(),{useOriginalFavicon:d}=(0,A.getPreferenceValues)();if((0,se.useEffect)(()=>{if(r&&n){let f=r.find(k=>k?.id===n);f&&o?s([{data:o.data,isLoading:o.isLoading,errorView:o.errorView,revalidate:o.revalidate,profile:f}]):(!o||!f)&&s([])}},[r,n,o]),l||a?.some(f=>f.errorView)){let f=a?.find(k=>k.errorView)?.errorView;return l||f}let h=Nt(e||""),g,x,$;return h.value?h.type==="url"?(g=`Open URL "${e}"`,$=A.Icon.Globe,x=(0,v.jsx)(U.NewTab,{url:h.value})):(g=`Search "${e}"`,$=A.Icon.MagnifyingGlass,x=(0,v.jsx)(U.NewTab,{query:e})):(g="Open Empty Tab",$=A.Icon.Plus,x=(0,v.jsx)(U.NewTab,{})),(0,v.jsxs)(A.List,{onSearchTextChange:t,isLoading:c||a?.find(f=>f.isLoading)?.isLoading,searchBarAccessory:(0,v.jsx)(je,{}),children:[(0,v.jsx)(A.List.Section,{title:"New Tab",children:(0,v.jsx)(A.List.Item,{title:g,icon:$,actions:(0,v.jsx)(v.Fragment,{children:x})})},"new-tab"),(0,v.jsx)(A.List.Section,{title:"Open Tabs - All",children:i?.map(f=>(0,v.jsx)(ae.TabList,{tab:f,useOriginalFavicon:d},f.key()))},"open-tabs"),_r(n,a).filter(f=>f?.profile?.id).map(f=>(0,v.jsx)(A.List.Section,{title:`History - ${f.profile.name}`,children:f.data?.map(k=>(0,v.jsx)(ae.TabHistory,{entry:k,profile:f.profile.id,type:"History"},`${f.profile.id}-${k.id}`))},f.profile.id))]})}
